import random
import torch


class ReIDAugment:
    def __init__(self, erase_prob=0.3):
        self.erase_prob = erase_prob

    def random_erasing(self, img):
        if random.random() > self.erase_prob:
            return img
        c, h, w = img.shape
        x = random.randint(0, w//2)
        y = random.randint(0, h//2)
        img[:, y:y+32, x:x+32] = 0
        return img

    def __call__(self, img):
        return self.random_erasing(img)

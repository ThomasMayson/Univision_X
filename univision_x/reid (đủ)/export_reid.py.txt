import torch
from reid.model import ReIDEncoder

model = ReIDEncoder()
model.load_state_dict(torch.load("weights/reid_encoder.pth"))
model.eval()

dummy = torch.randn(1,3,256,128)
torch.onnx.export(
    model, dummy, "reid_encoder.onnx",
    input_names=["image"],
    output_names=["embedding"],
    opset_version=12
)

import torch.nn as nn
from models.backbone.univisionx_backbone import UniVisionXBackbone
from .fpn import FPN
from .yolo_head import YOLOHead

class UniVisionX_Detector(nn.Module):
    def __init__(self, num_classes):
        super().__init__()
        self.backbone = UniVisionXBackbone()
        self.fpn = FPN()
        self.head4 = YOLOHead(256, num_classes)
        self.head5 = YOLOHead(256, num_classes)

    def forward(self, x):
        _, c4, c5 = self.backbone(x)
        p4, p5 = self.fpn(c4, c5)
        return [self.head4(p4), self.head5(p5)]

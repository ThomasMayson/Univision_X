import torch

class ReIDInfer:
    def __init__(self, encoder, device):
        self.encoder = encoder.to(device)
        self.device = device
        self.encoder.eval()

    @torch.no_grad()
    def __call__(self, crops):
        """
        crops: Tensor [N,3,256,128]
        """
        return self.encoder(crops.to(self.device))

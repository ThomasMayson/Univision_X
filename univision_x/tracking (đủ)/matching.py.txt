import numpy as np
from scipy.optimize import linear_sum_assignment

def hungarian_matching(cost_matrix, thresh):
    if cost_matrix.size == 0:
        return [], list(range(cost_matrix.shape[1]))

    row, col = linear_sum_assignment(cost_matrix)
    matches, unmatched = [], set(range(cost_matrix.shape[1]))

    for r, c in zip(row, col):
        if cost_matrix[r, c] < thresh:
            matches.append((r, c))
            unmatched.remove(c)

    return matches, list(unmatched)
